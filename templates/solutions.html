{% extends "base.html" %}

{% block title %}Solutions - MoodBank{% endblock %}

{% block content %}
<div class="text-center mb-8">
    <h1>Emotional Wellness Solutions</h1>
    <p style="font-size: 1.1rem;">Discover evidence-based techniques and strategies to support your emotional well-being.</p>
</div>

<div class="glass-card p-6 mb-6">
    <h3 style="margin-bottom: 16px;">Get Personalized Solutions</h3>
    <p style="margin-bottom: 16px; color: rgba(255, 255, 255, 0.9);">
        Select the emotions you're experiencing to receive tailored coping strategies and techniques.
    </p>
    <div class="emotion-selector">
        <div class="emotion-buttons">
            <button class="emotion-btn" data-emotion="anxiety">
                <i class="fas fa-exclamation-triangle"></i>
                Anxiety
            </button>
            <button class="emotion-btn" data-emotion="depression">
                <i class="fas fa-cloud-rain"></i>
                Depression
            </button>
            <button class="emotion-btn" data-emotion="stress">
                <i class="fas fa-bolt"></i>
                Stress
            </button>
            <button class="emotion-btn" data-emotion="anger">
                <i class="fas fa-fire"></i>
                Anger
            </button>
            <button class="emotion-btn" data-emotion="sadness">
                <i class="fas fa-heart-broken"></i>
                Sadness
            </button>
        </div>
        <button id="getSolutions" class="btn btn-primary" style="margin-top: 16px;">
            <i class="fas fa-search"></i>
            Get My Solutions
        </button>
    </div>
</div>

<div id="solutionsContainer">
    <div class="grid grid-3">
        <div class="glass-card p-6">
            <div class="solution-category">
                <i class="fas fa-brain" style="font-size: 2rem; color: #ffffff; margin-bottom: 16px;"></i>
                <h3>Cognitive Techniques</h3>
                <p>Mental strategies to reframe thoughts and manage emotional responses.</p>
                <ul class="solution-list">
                    <li>Mindfulness meditation</li>
                    <li>Cognitive restructuring</li>
                    <li>Thought challenging</li>
                    <li>Acceptance practices</li>
                </ul>
            </div>
        </div>
        
        <div class="glass-card p-6">
            <div class="solution-category">
                <i class="fas fa-running" style="font-size: 2rem; color: #ffffff; margin-bottom: 16px;"></i>
                <h3>Behavioral Strategies</h3>
                <p>Action-based approaches to improve mood and emotional regulation.</p>
                <ul class="solution-list">
                    <li>Regular exercise routine</li>
                    <li>Sleep hygiene practices</li>
                    <li>Social connection activities</li>
                    <li>Hobby engagement</li>
                </ul>
            </div>
        </div>
        
        <div class="glass-card p-6">
            <div class="solution-category">
                <i class="fas fa-leaf" style="font-size: 2rem; color: #ffffff; margin-bottom: 16px;"></i>
                <h3>Relaxation Methods</h3>
                <p>Techniques to reduce stress and promote emotional balance.</p>
                <ul class="solution-list">
                    <li>Deep breathing exercises</li>
                    <li>Progressive muscle relaxation</li>
                    <li>Yoga and stretching</li>
                    <li>Nature therapy</li>
                </ul>
            </div>
        </div>
    </div>
</div>

<div class="glass-container p-8 text-center" style="margin-top: 40px;">
    <h2>Emergency Resources</h2>
    <p style="margin-bottom: 24px; color: rgba(255, 255, 255, 0.9);">
        If you're experiencing a mental health crisis, please reach out for immediate help.
    </p>
    <div class="emergency-resources">
        <div class="resource-item">
            <strong>National Suicide Prevention Lifeline</strong><br>
            <span style="font-size: 1.2rem; color: #ffffff;">988</span>
        </div>
        <div class="resource-item">
            <strong>Crisis Text Line</strong><br>
            <span style="color: #ffffff;">Text HOME to 741741</span>
        </div>
        <div class="resource-item">
            <strong>Emergency Services</strong><br>
            <span style="font-size: 1.2rem; color: #ffffff;">911</span>
        </div>
    </div>
</div>

<style>
.emotion-buttons {
    display: flex;
    flex-wrap: wrap;
    gap: 12px;
    justify-content: center;
    margin-bottom: 16px;
}

.emotion-btn {
    background: rgba(255, 255, 255, 0.1);
    border: 2px solid rgba(255, 255, 255, 0.2);
    border-radius: 12px;
    padding: 12px 20px;
    color: #ffffff;
    cursor: pointer;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    gap: 8px;
    font-weight: 500;
    backdrop-filter: blur(10px);
}

.emotion-btn:hover {
    background: rgba(255, 255, 255, 0.2);
    transform: translateY(-1px);
}

.emotion-btn.selected {
    background: rgba(255, 255, 255, 0.3);
    border-color: rgba(255, 255, 255, 0.5);
    box-shadow: 0 0 20px rgba(255, 255, 255, 0.2);
}

.solution-category h3 {
    margin-bottom: 12px;
}

.solution-list {
    list-style: none;
    padding: 0;
}

.solution-list li {
    color: rgba(255, 255, 255, 0.9);
    padding: 8px 0;
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    position: relative;
    padding-left: 20px;
}

.solution-list li:last-child {
    border-bottom: none;
}

.solution-list li::before {
    content: '•';
    color: #ffffff;
    font-weight: bold;
    position: absolute;
    left: 0;
}

.personalized-solutions {
    margin-top: 30px;
}

.solution-section {
    background: rgba(255, 255, 255, 0.1);
    border: 1px solid rgba(255, 255, 255, 0.2);
    border-radius: 16px;
    padding: 24px;
    margin-bottom: 20px;
    backdrop-filter: blur(10px);
}

.solution-section h3 {
    display: flex;
    align-items: center;
    gap: 12px;
    margin-bottom: 16px;
    color: #ffffff;
}

.solution-section ul {
    list-style: none;
    padding: 0;
}

.solution-section li {
    color: rgba(255, 255, 255, 0.9);
    padding: 12px 0;
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    line-height: 1.5;
}

.solution-section li:last-child {
    border-bottom: none;
}

.solution-section li::before {
    content: '→';
    color: #ffffff;
    font-weight: bold;
    margin-right: 12px;
}

.emergency-resources {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 20px;
    margin-top: 20px;
}

.resource-item {
    background: rgba(255, 255, 255, 0.1);
    padding: 20px;
    border-radius: 12px;
    border: 1px solid rgba(255, 255, 255, 0.2);
    backdrop-filter: blur(10px);
}

.resource-item strong {
    color: #ffffff;
    display: block;
    margin-bottom: 8px;
}

@media (max-width: 768px) {
    .emotion-buttons {
        gap: 8px;
    }
    
    .emotion-btn {
        padding: 10px 16px;
        font-size: 14px;
    }
    
    .emergency-resources {
        grid-template-columns: 1fr;
        gap: 16px;
    }
}
</style>

<script>
let selectedEmotions = [];

// Emotion selection
document.querySelectorAll('.emotion-btn').forEach(btn => {
    btn.addEventListener('click', function() {
        const emotion = this.dataset.emotion;
        
        if (selectedEmotions.includes(emotion)) {
            selectedEmotions = selectedEmotions.filter(e => e !== emotion);
            this.classList.remove('selected');
        } else {
            selectedEmotions.push(emotion);
            this.classList.add('selected');
        }
    });
});

// Get solutions
document.getElementById('getSolutions').addEventListener('click', async function() {
    if (selectedEmotions.length === 0) {
        alert('Please select at least one emotion to get personalized solutions.');
        return;
    }
    
    try {
        const response = await fetch(`/api/solutions/${selectedEmotions.join(',')}`);
        const solutions = await response.json();
        
        let html = `
            <div class="personalized-solutions">
                <h2 style="text-align: center; margin-bottom: 30px; color: #ffffff;">
                    <i class="fas fa-heart"></i>
                    Your Personalized Solutions
                </h2>
        `;
        
        if (solutions.techniques && solutions.techniques.length > 0) {
            html += `
                <div class="solution-section">
                    <h3>
                        <i class="fas fa-brain"></i>
                        Recommended Techniques
                    </h3>
                    <ul>
                        ${solutions.techniques.map(technique => `<li>${technique}</li>`).join('')}
                    </ul>
                </div>
            `;
        }
        
        if (solutions.affirmations && solutions.affirmations.length > 0) {
            html += `
                <div class="solution-section">
                    <h3>
                        <i class="fas fa-quote-left"></i>
                        Positive Affirmations
                    </h3>
                    <ul>
                        ${solutions.affirmations.map(affirmation => `<li>"${affirmation}"</li>`).join('')}
                    </ul>
                </div>
            `;
        }
        
        if (solutions.activities && solutions.activities.length > 0) {
            html += `
                <div class="solution-section">
                    <h3>
                        <i class="fas fa-tasks"></i>
                        Helpful Activities
                    </h3>
                    <ul>
                        ${solutions.activities.map(activity => `<li>${activity}</li>`).join('')}
                    </ul>
                </div>
            `;
        }
        
        html += `
                <div class="text-center" style="margin-top: 30px;">
                    <p style="color: rgba(255, 255, 255, 0.9); margin-bottom: 16px;">
                        Remember: These are general suggestions. For persistent emotional difficulties, consider consulting with a mental health professional.
                    </p>
                    <button onclick="location.reload()" class="btn btn-primary">
                        <i class="fas fa-refresh"></i>
                        Get New Solutions
                    </button>
                </div>
            </div>
        `;
        
        document.getElementById('solutionsContainer').innerHTML = html;
        
        // Scroll to solutions
        document.querySelector('.personalized-solutions').scrollIntoView({ 
            behavior: 'smooth',
            block: 'start'
        });
        
    } catch (error) {
        console.error('Error getting solutions:', error);
        alert('Error getting solutions. Please try again.');
    }
});
</script>
{% endblock %}
